{"version":3,"sources":["webpack:///./src/components/layout.js","webpack:///./src/labels/regions.js","webpack:///./src/components/region-selector.js","webpack:///./src/components/date-selector.js","webpack:///./src/pages/index.js"],"names":["Layout","location","title","children","isRootPath","pathname","className","to","data-is-root-path","href","Regions","RegionSelector","props","regions","state","dispatch","items","push","key","value","Object","entries","region","onChange","event","type","target","DateSelector","dates","date","Index","data","regionsDates","allRegionsZonesCsv","edges","forEach","item","index","node","Date","zones","allMarkdownRemark","nodes","frontmatter","id","html","zoneLabels","label","d","initialState","getDate","getMonth","getFullYear","getZoneCode","getCurrentZoneCode","code","sameZones","getZoneLabel","values","filter","self","indexOf","length","useReducer","action","Error","keys","getHeader","dangerouslySetInnerHTML","__html"],"mappings":"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","file":"component---src-pages-index-js-b17be227ca469cbf1611.js","sourcesContent":["import React from \"react\"\nimport { Link } from \"gatsby\"\n\nconst Layout = ({ location, title, children }) => {\n  const rootPath = `${__PATH_PREFIX__}/`\n  const isRootPath = location.pathname === rootPath\n  let header\n\n  if (isRootPath) {\n    header = (\n      <h1 className=\"main-heading\">\n        <Link to=\"/\">{title}</Link>\n      </h1>\n    )\n  } else {\n    header = (\n      <Link className=\"header-link-home\" to=\"/\">\n        {title}\n      </Link>\n    )\n  }\n\n  // @todo: display site name?\n\n  return (\n    <div className=\"global-wrapper\" data-is-root-path={isRootPath}>\n      <header className=\"global-header\"></header>\n      <main>{children}</main>\n      <footer>\n          <a href=\"/\">Termini di utilizzo</a> - {` `}\n          <a href=\"https://docs.google.com/forms/d/e/1FAIpQLSfiuthLNYyeeOd1n5J0dHclP-3mrRvv8K4lQGzkBlGem8-nzA/viewform\">Contatti</a> - {` `}\n          <a href=\"https://github.com/mmolinari/oggiposso\">GitHub</a>\n      </footer>\n    </div>\n  )\n}\n\nexport default Layout\n","// Map keys to labels.\nexport const Regions = {\n    \"Abruzzo\": \"Abruzzo\",\n    \"Basilicata\": \"Basilicata\",\n    \"Calabria\": \"Calabria\",\n    \"Campania\": \"Campania\",\n    \"Emilia_Romagna\": \"Emilia-Romagna\",\n    \"Friuli_Venezia_Giulia\": \"Friuli-Venezia Giulia\",\n    \"Lazio\": \"Lazio\",\n    \"Liguria\": \"Liguria\",\n    \"Lombardia\": \"Lombardia\",\n    \"Marche\": \"Marche\",\n    \"Molise\": \"Molise\",\n    \"Piemonte\": \"Piemonte\",\n    \"Puglia\": \"Puglia\",\n    \"Sardegna\": \"Sardegna\",\n    \"Sicilia\": \"Sicilia\",\n    \"Toscana\": \"Toscana\",\n    \"Trentino_Alto_Adige\": \"Trentino-Alto Adige\",\n    \"Valle_d_Aosta\": \"Valle d'Aosta\",\n    \"Veneto\": \"Veneto\",\n};","import React from \"react\"\n\nfunction RegionSelector(props) {\n    const { regions, state, dispatch } = props;\n\n    const handleChange = (event) => {\n        dispatch({type: 'region', 'region': event.target.value});\n    }\n\n    const items = []\n    items.push(<option key=\"0\" value=\"0\">Scegli una regione</option>)\n    for (const [key, value] of Object.entries(regions)) {\n        items.push(<option key={key} value={key}>{value}</option>)\n    }\n\n    return (\n        <select value={state.region} onChange={handleChange}>\n            {items}\n        </select>\n    );\n}\n\nexport default RegionSelector\n","import React from \"react\"\n\nfunction DateSelector({ dates, state, dispatch }) {\n    const handleChange = (event) => {\n        dispatch({type: 'date', 'date': event.target.value});\n    }\n\n    const items = []\n    items.push(<option key=\"0\" value=\"0\">Scegli un giorno</option>)\n\n    for (const value of dates) {\n        items.push(<option key={value} value={value}>{value}</option>)\n    }\n\n    return (\n        <select value={state.date} onChange={handleChange}>\n            {items}\n        </select>\n    );\n}\n\nexport default DateSelector\n","import React, { useReducer } from \"react\"\nimport { graphql } from \"gatsby\"\nimport { Regions } from \"../labels/regions\";\nimport RegionSelector from \"../components/region-selector\";\nimport DateSelector from \"../components/date-selector\";\nimport Layout from \"../components/layout\";\n\n\nexport default function Index({ data, location }) {\n    const regionsDates = {};\n    data.allRegionsZonesCsv.edges.forEach(function (item, index) {\n        regionsDates[item.node.Date] = item.node;\n    });\n\n    const zones = {};\n    data.allMarkdownRemark.nodes.forEach(function (item, index) {\n        zones[item.frontmatter.id] = item.html;\n    });\n\n    const zoneLabels = {};\n    data.allMarkdownRemark.nodes.forEach(function (item, index) {\n        zoneLabels[item.frontmatter.id] = item.frontmatter.label;\n    });\n\n    const d = new Date();\n    const today = d.getDate() + \"/\" + (d.getMonth() + 1) + \"/\" + d.getFullYear();\n\n    const initialState = {region: 0, date: today};\n\n    function reducer(state, action) {\n        switch (action.type) {\n            case 'region':\n                return {region: action.region, date: state.date};\n            case 'date':\n                return {region: state.region, date: action.date};\n            default:\n                throw new Error();\n        }\n    }\n\n    function getZoneCode(date, region) {\n        if (region !== 0 && date !== 0) {\n            return regionsDates[date][region];\n        }\n        else {\n            return '';\n        }\n    }\n\n    function getCurrentZoneCode() {\n        let code = getZoneCode(state.date, state.region);\n        // If all regions are in the same zone, the region is not mandatory.\n        if (sameZones(state.date) && code === \"\") {\n            code = getZoneCode(state.date, 'Lombardia');\n        }\n        return code;\n    }\n\n    function getZoneLabel() {\n        const code = getCurrentZoneCode();\n        if (code) {\n            return zoneLabels[code];\n        }\n    }\n\n    function getZoneText() {\n        const code = getCurrentZoneCode();\n        if (code) {\n            return zones[code];\n        }\n        else if (sameZones(state.date)) {\n            return zones[getZoneCode(state.date, 'Lombardia')];\n        }\n        else {\n            return \"Per favore scegli una regione e una data.\";\n        }\n    }\n\n    function getDate() {\n        return state.date !== 0 ? state.date : '';\n    }\n\n    function getRegion() {\n        return state.region !== 0 ? Regions[state.region] : '';\n    }\n\n    function getHeader() {\n        let code = getCurrentZoneCode();\n        if (code) {\n            if (sameZones(state.date)) {\n                return \"Tutte le regioni, \" + getDate() + \": \" + getZoneLabel();\n            }\n            else {\n                return getRegion() + \", \" + getDate() + \": \" + getZoneLabel();\n            }\n        }\n    }\n\n    // Returns whether all regions are in the same zone.\n    function sameZones(date) {\n        const dayZones = Object.values(regionsDates[date]);\n        const uniqueZones = dayZones.filter((value, index, self) => {\n            return self.indexOf(value) === index;\n        });\n        // Date is also a property.\n        return uniqueZones.length === 2;\n    }\n\n    const siteTitle = \"Oggi Posso\";\n\n    const [state, dispatch] = useReducer(reducer, initialState);\n\n    return (\n        <Layout location={location} title={siteTitle}>\n            <form>\n                <RegionSelector regions={Regions} state={state} dispatch={dispatch} />\n                <DateSelector dates={Object.keys(regionsDates)} state={state} dispatch={dispatch} />\n                <h2 className={getCurrentZoneCode()}>\n                    { getHeader() }\n                </h2>\n                <div dangerouslySetInnerHTML={{ __html: getZoneText() }} />\n            </form>\n        </Layout>\n    )\n}\n\nexport const query = graphql`\n    {\n      allRegionsZonesCsv {\n        edges {\n          node {\n            Date\n            Abruzzo\n            Basilicata\n            Calabria\n            Campania\n            Emilia_Romagna\n            Friuli_Venezia_Giulia\n            Lazio\n            Liguria\n            Lombardia\n            Marche\n            Molise\n            Piemonte\n            Puglia\n            Sardegna\n            Sicilia\n            Toscana\n            Trentino_Alto_Adige\n            Umbria\n            Valle_d_Aosta\n            Veneto\n          }\n        }\n      }\n      allMarkdownRemark {\n        nodes {\n          html\n          frontmatter {\n            id\n            label\n            language\n          }\n        }\n      }\n    }\n`\n"],"sourceRoot":""}